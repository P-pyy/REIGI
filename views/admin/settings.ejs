<%- include('../partials/admin/sidebar') %>

<link rel="stylesheet" href="/css/settings.css">

<div class="container-fluid d-flex p-0 min-vh-100 account-settings">

  <!-- HEADER -->
  <header class="main-header d-flex justify-content-between align-items-center">
    <h1 class="mb-0">Account Settings</h1>
  </header>

  <!-- MAIN CONTENT -->
  <main class="main-content flex-grow-1">
    <div class="container" id="account-settings-container">

      <!-- Security Settings -->
      <section class="card" id="security-settings">
        <h2 class="card-title">Security Settings</h2>
        <nav class="nav-links">
          <div class="setting-option">
            <a href="#" class="swap-link" data-target="change-password-form">
              <span>Change Password</span>
              <i class="arrow-icon"></i>
            </a>
          </div>
          <div class="setting-option">
            <a href="#" class="swap-link" data-target="login-alerts-form">
              <span>Login Alerts</span>
              <i class="arrow-icon"></i>
            </a>
          </div>
        </nav>
      </section>

      <!-- Account History -->
      <section class="card" id="account-history">
        <h2 class="card-title">Account History</h2>
        <nav class="nav-links">
          <a href="#" class="swap-link" data-target="login-history-form">
            <span>Login History</span>
            <i class="arrow-icon"></i>
          </a>
        </nav>
      </section>

          <!-- Change Password Form -->
          <section
            class="form-container form-section"
            id="change-password-form"
            style="display: none"
          >
            <h2 class="change-pass-title">Change Password</h2>
            <form id="changePasswordForm" class="change-password-form" autocomplete="off">
              <input
                type="password"
                name="currentPassword"
                placeholder="Current Password"
                required
              />
              <input
                type="password"
                name="newPassword"
                placeholder="New Password"
                required
                minlength="8"
              />
              <input
                type="password"
                name="reenterNewPassword"
                placeholder="Re-enter New Password"
                required
                minlength="8"
              />
              <button type="submit">Submit</button>
            </form>
          </section>

          <!-- Change Email Form -->
          <section
            class="form-container form-section"
            id="change-email-form"
            style="display: none"
          >
            <h2 class="card-title">Change Email</h2>
            <form id="changeEmailForm" autocomplete="off">
              <input
                type="email"
                name="currentEmail"
                placeholder="Current Email"
                required
              />
              <input
                type="email"
                name="newEmail"
                placeholder="New Email"
                required
              />
              <button type="submit">Submit</button>
            </form>
          </section>

         <!-- Login Alerts -->
          <section class="form-container form-section" id="login-alerts-form" style="display: none">

            <div class="d-flex justify-content-between align-items-center mb-3">
              <button class="icon-btn back-btn" aria-label="Go back">
                <i class="bi bi-arrow-left"></i>
              </button>
              <button class="icon-btn close-btn" aria-label="Close">
                <i class="bi bi-x-lg"></i>
              </button>
            </div>

            <div>
                <h2 class="m-0 flex-grow-1 text-left">Login Alerts</h2>
            </div>

            <p class="subtitle">
              Set how you want to be notified about unrecognized logins.
            </p>

            <form>
              <fieldset class="options">
                <div
                  class="d-flex justify-content-between align-items-center mb-3"
                >
                  <span>In-App Notifications</span>
                  <div class="form-check m-0">
                    <input
                      type="checkbox"
                      id="alertInApp"
                      class="form-check-input"
                      checked
                    />
                  </div>
                </div>

                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <span>Email</span><br />
                    <small class="text-muted" id="alertEmail">
                      <!-- User email will load dynamically -->
                    </small>
                  </div>
                  <div class="form-check m-0">
                    <input
                      type="checkbox"
                      id="alertEmailCheckbox"
                      class="form-check-input"
                      checked
                    />
                  </div>
                </div>
              </fieldset>
            </form>
          </section>

          <!-- Login History -->
          <section
            class="form-container form-section"
            id="login-history-form"
            style="display: none"
          >
            <div class="d-flex justify-content-between align-items-center mb-2">
              <button class="icon-btn back-btn" aria-label="Go back">
                <i class="bi bi-arrow-left"></i>
              </button>
              <button class="icon-btn close-btn" aria-label="Close">
                <i class="bi bi-x-lg"></i>
              </button>
            </div>

            <div>
              <h2 class="m-0 flex-grow-1 text-left">Login History</h2>
            </div>

            <section class="mb-4">
              <p>Your current login session:</p>
              <div class="device-item current" id="currentDevice">
                <!-- Current session info loads here -->
              </div>
            </section>

            <section>
              <h4>Saved Devices</h4>
              <div class="device-list" id="loginHistoryList">
                <!-- History items load dynamically -->
              </div>
            </section>
          </section>

    </div>
  </main>
</div>

<!-- script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/1.0.2/ua-parser.min.js"></script>
<script type="module" src="/js/settings.js"></script>
